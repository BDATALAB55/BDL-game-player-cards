<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <style>
        @charset "UTF-8";
        body {
            font-family: "Avenir Next", "Helvetica Neue", Arial, sans-serif;
            margin: 0; padding: 0; background-color: #292929; color: #FFFFFF;
            width: 1200px; height: 1653px; overflow: hidden;
        }

        /* --- ヘッダー --- */
        .header { display: flex; height: 350px; width: 100%; }
        .team-box { flex: 1; padding: 20px 40px; position: relative; display: flex; flex-direction: column; justify-content: space-between; overflow: hidden; z-index: 1; }
        .home { background-color: __HOME_BG__ !important; color: #FFFFFF; }
        .away { background-color: __AWAY_BG__ !important; color: #FFFFFF; }
        .winner-color { color: #FFD932 !important; }
        .accent { position: absolute; top: 0; left: 0; width: 350px; height: 350px; z-index: 1; background: linear-gradient(135deg, var(--accent-color) 50%, transparent 50%); pointer-events: none; }
        .home .accent { --accent-color: __HOME_DARK__; }
        .away .accent { --accent-color: __AWAY_DARK__; }
        .city-part { font-size: 35px; font-weight: 600; letter-spacing: 0.1em; line-height: 1.0; margin-top: 13px; margin-bottom: 10px; position: relative; z-index: 5; }
        .nick-part { font-size: 56px; font-weight: 700; letter-spacing: 0.13em; line-height: 1; white-space: nowrap; position: relative; z-index: 5; }
        .score-val { font-size: 115px; font-weight: 700; text-align: right; line-height: 0.8; margin-bottom: 20px; letter-spacing: 0.16em; position: relative; z-index: 5; }

        /* --- サブヘッダー --- */
        .sub-header { background-color: #292929; height: 173px; display: flex; justify-content: space-between; padding: 30px 40px 0 40px; box-sizing: border-box; }
        .info-label { color: #888; font-size: 30px; font-family: 'Arial Black', sans-serif; letter-spacing: 0.2em; margin-right: 20px; }
        .info-value { font-size: 32px; font-weight: 600; letter-spacing: 0.13em; }
        .info-right { display: flex; flex-direction: column; gap: 16px; align-items: flex-end; }
        .category-badge { background-color: #FFFFFF; color: #000; width: 300px; height: 58px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 30px; letter-spacing: 0.2em; }

        .round-badge {
    margin-top: -2px;
    width: 300px;
    height: 58px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 26px;
    letter-spacing: 0.15em;
    background-color: #FFFFFF !important; /* 背景を白に！ */
    color: #000000 !important;          /* 文字を黒に！ */
    text-transform: uppercase;
    box-sizing: border-box;
    border-radius: 2px;
}

        /* --- プレイヤーセクション --- */
        .player-section { background-color: __PLAYER_BG__; color: __PLAYER_TEXT__; height: 185px; padding: 30px 40px 60px 40px; position: relative; display: flex; flex-direction: column; justify-content: flex-end; }
        .player-no { font-size: 180px; font-weight: 650; position: absolute; top: 15px; left: 60px; line-height: 1; color: __PLAYER_DARK__; letter-spacing: -0.1em; z-index: 1; }
        .player-name { font-size: 60px; font-weight: 650; z-index: 10; letter-spacing: 0.13em; color: #000000; -webkit-text-stroke: 2.0px #FFFFFF; line-height: 1; position: absolute; bottom: 90px; left: 60px; text-transform: uppercase; white-space: nowrap; transform-origin: left bottom; }
        .starter-mark { position: absolute; bottom: 35px; right: 60px; font-size: 120px; font-weight: 700; color: __PLAYER_BG__; -webkit-text-stroke: 3px __PLAYER_TEXT__; }

        /* プレイヤー右上のチーム名表示（都市名 チーム名） */
        .player-team-full { position: absolute; top: 30px; right: 40px; font-size: 38px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; }
        
                /* スタッツエリア全体の背景 */
        .all-stats-area {
            background-color: #292929; 
    height: 100%;
    display: block !important;
    gap: 40px;              /* これでグリッド同士の間隔を強制的に作ります */
    padding-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
    gap: 0px;
            padding: 40px 20px 40px 40px;
        }

        .stat-card {
            background-color: transparent; 
            align-items: center;
            display: flex;
    flex-direction: column;
        }

        .stat-label { 
          font-size: 35px; 
          font-weight: 700; 
          letter-spacing: 0.06em;
          color: __PLAYER_BG__;
          -webkit-text-stroke: 1px #FFFFFF; 
          margin-bottom: 15px;
          text-align: left;
          display: block;
          width: 110%;
        position: relative;top: -10px;
        margin-bottom: -10px; }

        .stat-value { 
          font-size: 120px; 
          font-weight: 700;
          letter-spacing: 0.02em;
         position: relative;
         top: 45px;}

         .stats-grid:first-of-type .stat-card:nth-child(1) {
    align-items: flex-start !important; /* PTSのカード全体を左寄せ */
    overflow: visible !important;
}

.stats-grid:first-of-type .stat-card:nth-child(1) .stat-label {
    margin-left: 0;
    text-align: left;
}

.stats-grid:first-of-type .stat-card:nth-child(1) .stat-value {
  display: inline-block !important; /* 動かすために必要 */
    transform: translateX(-40px) !important; /* 数値だけを左へ物理的にスライド */
    text-align: left !important;
    width: 100% !important;
    z-index: 100 !important;
    position: relative !important;
}

.stats-grid:nth-of-type(2) {
    margin-top: 60px; /* 20pxから少し広げて、上下の重なりを防ぐ */
}

.stats-grid:nth-of-type(2) .stat-card {
    align-items: center !important;
}

.stats-grid .stat-card:nth-child(4) {
    display: flex;
    flex-direction: column;
    align-items: center; /* 横方向の中央 */
    text-align: center;
}

.stats-grid .stat-card:nth-child(4) .stat-label {
    text-align: center;
    position: relative;
    top: -10px; /* 他のラベルと高さを合わせる */
    margin-bottom: 0;
}

.stats-grid .stat-card:nth-child(4) .chart-container {
    margin-top: 100px; /* 数値が大きいほど上に上がります */
}

.stats-grid .stat-card:nth-child(4) .custom-legend {
    margin-top: 15px;
}

.reb-container {
    display: flex;
    align-items: baseline; /* 底辺を揃える */
    justify-content: flex-start; /* 左寄せ（中央にしたい場合は center） */
    gap: -50px; /* メイン数値と内訳の間隔 */
    white-space: nowrap;
}

.main-reb {
    font-size: 120px; /* 元のサイズを維持 */
    font-weight: 700;
}

.sub-reb {
    font-size: 56px;  /* 内訳は小さくして視認性を分ける */
    font-weight: 600;
    color: #FFFFFF;
    letter-spacing: 0.05em;
    position: relative;
    top: -5px;        /* 底辺が微妙にズレる場合の微調整用 */
    margin-left: 60px;
}

.stats-grid[style*="margin-top: -60px"] .stat-card {
    padding-left: 20px; /* ドーナツ同士の間隔を確保 */
}
        
        .bottom-stats {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            padding: 0 40px;
        }
        .mini-card {
            background-color: transparent;
            text-align: center;
        }
        .mini-label { 
          font-size: 35px; 
          font-weight: 700; 
          letter-spacing: 0.15em;
          color: __PLAYER_BG__;
          -webkit-text-stroke: 1px #FFFFFF; 
          margin-bottom: 5px; }

        .mini-value { 
          font-size: 60px; 
          font-weight: 550; }

        .charts-area {
            font-size: 40px;
            font-weight: 700;
            color: __PLAYER_BG__;
            -webkit-text-stroke: 1px #FFFFFF;
            text-align: center;
            margin-bottom: 10px;
            }

        .chart-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0px;
        margin: 0 auto;
    }

    .custom-legend {
        display: flex;
        justify-content: center;
        gap: 20px;
        font-size: 22px; /* 視認性を高めるため少し大きくしました */
        font-weight: 600;
        color: #FFFFFF;
        text-transform: uppercase;
        margin-top: 0px; 
        position: relative;
        z-index: 20;
        }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .dot {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        display: inline-block;
    }

    .stat-str-value {
    font-size: 48px !important;    /* 30pxから一気に48pxへ */
    font-weight: 600 !important;    /* 圧倒的な太さ */
    margin-top: 0px !important;    /* チャートとの隙間を確保 */
    letter-spacing: 0.05em;
    color: #FFFFFF;
    font-family: "Avenir Next";
    display: block;
    text-align: center;
}

    /* 30チームのカラーを自動で引っ張る設定 */
    .dot.p2 { background-color: __PLAYER_BG__; }  
    .dot.p3 { background-color: __PLAYER_COLOR2__; } 
    .dot.ft { background-color: #999999; }

    </style>
</head>
<body data-color1="__PLAYER_BG__" data-color2="__PLAYER_COLOR2__" data-text1="__PLAYER_TEXT__">
    <div class="header">
        <div class="team-box away">
            <div class="accent"></div>
            <div><div class="city-part">__AWAY_CITY__</div><div class="nick-part">__AWAY_NICK__</div></div>
            <div class="score-val" id="score-a">__AWAY_SCORE__</div>
        </div>
        <div class="team-box home">
            <div class="accent"></div>
            <div><div class="city-part">__HOME_CITY__</div><div class="nick-part">__HOME_NICK__</div></div>
            <div class="score-val" id="score-h">__HOME_SCORE__</div>
        </div>
    </div>

    <div class="sub-header">
        <div class="info-left">
            <div style="display: flex; gap: 50px;">
                <div><span class="info-label">Date</span><span class="info-value">__DATE__</span></div>
                <div><span class="info-label">Attendance</span><span class="info-value">__ATTENDANCE__</span></div>
            </div>
            <div style="margin-top:15px;"><span class="info-label">Location</span><span class="info-value">__VENUE__</span></div>
        </div>
        <div class="info-right">
            <div class="category-badge">__LEAGUE_TYPE__</div>
            <div class="round-badge">__ROUND__</div>
        </div>
    </div>

    <div class="player-section">
        <div class="starter-mark">__STARTER__</div>
        <div class="player-no">__PLAYER_NO__</div>
        <div class="player-name">__PLAYER_NAME__</div>
        <div class="player-team-full">__PLAYER_CITY__ __PLAYER_NICK__</div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">PTS</div>
            <div class="stat-value"style="margin-left: -80px">__PTS__</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">REB</div>
            <div class="stat-value reb-container">
                <span class="main-reb">__REB__</span>
                <span class="sub-reb">__OREB__ / __DREB__</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-label"style="margin-left: 90px">AST</div>
            <div class="stat-value">__AST__</div>
        </div>
        <div class="stat-card">
            <div class="stat-label" style="text-align: center;">PTS RATIO</div>
            <div class="chart-container" style="margin-top: 0px;">
                <canvas id="ptsRatioChart" width="195" height="195"></canvas>
                <div class="custom-legend">
                    <span class="legend-item"><span class="dot p2"></span>2P</span>
                    <span class="legend-item"><span class="dot p3"></span>3P</span>
                    <span class="legend-item"><span class="dot ft"></span>FT</span>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-grid" style="margin-top: -60px;">
        <div class="stat-card">
    <div class="stat-label"style="margin-left: -20px">2FG</div>
    <div class="chart-container" style="position: relative;">
        <canvas id="chart2fg" width="200" height="200"></canvas>
        <div id="pct-label-2fg" style="position: absolute; top: 62px; width: 100%; text-align: center; font-family: 'Avenir Next', sans-serif; font-size: 56px; font-weight: 600; color:#FFFFFF;"></div>
        <div class="stat-str-value">__FG2STR__</div>
    </div>
</div>

<div class="stat-card">
    <div class="stat-label">3FG</div>
    <div class="chart-container" style="position: relative;">
        <canvas id="chart3fg" width="200" height="200"></canvas>
        <div id="pct-label-3fg" style="position: absolute; top: 62px; width: 100%; text-align: center; font-family: 'Avenir Next', sans-serif; font-size: 56px; font-weight: 600; color:#FFFFFF;"></div>
        <div class="stat-str-value">__FG3STR__</div>
    </div>
</div>

<div class="stat-card">
    <div class="stat-label"style="margin-left: 90px">FT</div>
    <div class="chart-container" style="position: relative;">
        <canvas id="chartft" width="200" height="200"></canvas>
        <div id="pct-label-ft" style="position: absolute; top: 62px; width: 100%; text-align: center; font-family: 'Avenir Next', sans-serif; font-size: 56px; font-weight: 600; color:#FFFFFF;"></div>
        <div class="stat-str-value">__FTSTR__</div>
    </div>
</div>

        <div class="stat-card">
            <div class="stat-label" style="text-align: center;">Attempt RATIO</div>
            <div class="chart-container" style="margin-top: -10px;">
                <canvas id="attRatioChart" width="195" height="195"></canvas>
                <div class="custom-legend">
                    <span class="legend-item"><span class="dot p2"></span>2P</span>
                    <span class="legend-item"><span class="dot p3"></span>3P</span>
                </div>
            </div>
        </div>
    </div>

        <div style="height: 10px;"></div> 
        <div style="margin-top: -20px;"></div>
        <div class="bottom-stats">
            <div class="mini-card">
              <div class="mini-label"style="margin-left: -100px">MIN</div>
            <div class="mini-value">__MIN__</div></div>
            <div class="mini-card"><div class="mini-label">TOV</div><div class="mini-value">__TO__</div></div>
            <div class="mini-card"><div class="mini-label">STL</div><div class="mini-value">__STL__</div></div>
            <div class="mini-card"><div class="mini-label">BLK</div><div class="mini-value">__BLK__</div></div>
            <div class="mini-card"><div class="mini-label">PF</div><div class="mini-value">__PF__</div></div>
            <div class="mini-card"><div class="mini-label">+/-</div><div class="mini-value">__PM__</div></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script>
        window.drawCharts = function(data) {
            Chart.register(ChartDataLabels);
            const h = parseInt(data.scoreHome);
            const a = parseInt(data.scoreAway);
            if (h > a) document.getElementById('score-h').classList.add('winner-color');
            else if (a > h) document.getElementById('score-a').classList.add('winner-color');

            const c1 = document.body.getAttribute('data-color1');
            const c2 = document.body.getAttribute('data-color2');

            // 名前のはみ出し調整
            const nameEl = document.querySelector('.player-name');
            if (nameEl && nameEl.offsetWidth > 1000) {
                nameEl.style.transform = `scaleX(${1000 / nameEl.offsetWidth})`;
            }

            // ドーナツグラフ共通関数
            const drawDonut = (id, pct, labelId) => {
                const val = parseFloat(pct) || 0; 
                new Chart(document.getElementById(id), {
                    type: 'doughnut',
                    data: { datasets: [{ data: [val, 100 - val], backgroundColor: [c1, '#5e5e5e'], borderWidth: 0 }] },
                    options: { cutout: '70%', responsive: false, animation: false, plugins: { datalabels: { display: false } } }
                });
                const label = document.getElementById(labelId);
                if (label) label.innerText = val > 0 ? val.toFixed(1) : "0.0";
            };

            drawDonut('chart2fg', data.fg2Pct, 'pct-label-2fg');
            drawDonut('chart3fg', data.fg3Pct, 'pct-label-3fg');
            drawDonut('chartft', data.ftPct, 'pct-label-ft');

            // 円グラフ共通オプション
            const pieOptions = {
                responsive: false, animation: false,
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        color: '#FFF',
                        font: { size: 36, weight: '600', family: 'Avenir Next' },
                        formatter: (v) => v > 5 ? v + '%' : ''
                    }
                }
            };

            new Chart(document.getElementById('ptsRatioChart'), {
                type: 'pie',
                data: { datasets: [{ data: [data.ptsRatio2P, data.ptsRatio3P, data.ptsRatioFT], backgroundColor: [c1, c2, '#999999'], borderWidth: 0 }] },
                options: pieOptions
            });

            new Chart(document.getElementById('attRatioChart'), {
                type: 'pie',
                data: { datasets: [{ data: [data.attRatio2P, data.attRatio3P], backgroundColor: [c1, c2], borderWidth: 0 }] },
                options: pieOptions
            });
        };
    </script>
</body>
</html>